(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34441,        888]
NotebookOptionsPosition[     33027,        836]
NotebookOutlinePosition[     33390,        852]
CellTagsIndexPosition[     33347,        849]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pressure calculations for the deterministic wall model", "Section",
 CellChangeTimes->{{3.6563544603869905`*^9, 3.6563544892462454`*^9}}],

Cell[BoxData[{
 RowBox[{"Started", " ", 
  RowBox[{
   RowBox[{"10", "/", "11"}], "/", "2015"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"To", " ", 
   RowBox[{"do", ":", " ", 
    RowBox[{"grid", " ", "spacing"}]}]}], ";", " ", 
  RowBox[{"more", " ", "alphas"}]}]}], "Input",
 CellChangeTimes->{{3.6563545255204496`*^9, 3.6563545358593483`*^9}, {
  3.6563545796765842`*^9, 3.656354596169588*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Subsubsection",
 CellChangeTimes->{{3.656270973263586*^9, 3.656270976394676*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", 
   RowBox[{"\[Theta]_", ",", "\[Theta]0_", ",", 
    RowBox[{"\[Alpha]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"Log", "[", 
     FractionBox["\[Theta]", "\[Theta]0"], "]"}]}], "-", "\[Theta]", "+", 
   "\[Theta]0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]0", "[", 
   RowBox[{
    RowBox[{"\[Theta]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Delta]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Alpha]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Theta]0", "/.", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]", "[", 
        RowBox[{"\[Theta]", ",", "\[Theta]0", ",", "\[Alpha]"}], "]"}], 
       "\[Equal]", "\[Delta]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]0", ",", 
        RowBox[{"\[Alpha]", "+", "\[Theta]"}]}], "}"}]}], "]"}]}], "//", 
   "Re"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "[", 
   RowBox[{"\[Theta]_", ",", 
    RowBox[{"\[Theta]0_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Alpha]_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[Theta]0", 
     FractionBox[
      SqrtBox[
       RowBox[{
        SuperscriptBox["\[Theta]0", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Theta]0", "-", "\[Alpha]"}], ")"}], "2"]}]], 
      RowBox[{
       SuperscriptBox["\[Theta]", "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Theta]", "-", "\[Alpha]"}], ")"}], "2"]}]], 
     FractionBox[
      SqrtBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Theta]", "-", "\[Alpha]"}], ")"}], "2"]], 
      RowBox[{"(", 
       RowBox[{"\[Theta]0", "-", "\[Alpha]"}], ")"}]]}], ")"}], "*", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{"2", "\[Pi]"}]]], 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[Theta]0", "2"]}], "/", "2"}], "]"}], 
   RowBox[{"HeavisideTheta", "[", 
    RowBox[{"\[Theta]0", "-", "\[Alpha]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6430440402148857`*^9, 3.6430440519617248`*^9}, {
   3.6430441177386136`*^9, 3.6430441335351534`*^9}, {3.643044165261322*^9, 
   3.6430441791926174`*^9}, {3.6430442996800117`*^9, 3.643044320656007*^9}, {
   3.643050511622656*^9, 3.64305051261832*^9}, {3.643054538687174*^9, 
   3.6430545536421533`*^9}, {3.6430546114207053`*^9, 3.643054643396041*^9}, {
   3.6561763555980673`*^9, 3.6561764861133766`*^9}, 3.6561766618339224`*^9, 
   3.656176706158573*^9, {3.656176921710767*^9, 3.6561769252781534`*^9}, 
   3.6561772514793634`*^9, 3.656179694063319*^9, {3.6561797390073853`*^9, 
   3.6561797766715794`*^9}, {3.6561799054016943`*^9, 3.656179910818318*^9}, {
   3.65618034505307*^9, 3.656180346437996*^9}, {3.6561804591073675`*^9, 
   3.6561804617351246`*^9}, {3.6561839712087717`*^9, 
   3.6561839771817665`*^9}, {3.6562501015488586`*^9, 3.656250101852061*^9}, {
   3.6562501433857975`*^9, 3.6562501782070503`*^9}, 3.656250218390887*^9, {
   3.6562506272239065`*^9, 3.6562507341683254`*^9}, {3.6562509978824353`*^9, 
   3.656251002885776*^9}, {3.6562512651849413`*^9, 3.6562512933477545`*^9}, 
   3.6562514289493046`*^9, {3.656252288446282*^9, 3.65625232075886*^9}, {
   3.656266372452135*^9, 3.6562663732426634`*^9}, {3.656268207204394*^9, 
   3.6562682153198137`*^9}, {3.6562691149025593`*^9, 
   3.6562692204570494`*^9}, {3.656269451627427*^9, 3.656269463090083*^9}, {
   3.65626963074104*^9, 3.6562696318787994`*^9}, {3.6562705667711277`*^9, 
   3.656270655739541*^9}, {3.65633123129316*^9, 3.656331313574061*^9}, {
   3.6563529236696367`*^9, 3.656352928231679*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Alphas to consider", "Subsubsection",
 CellChangeTimes->{{3.6563545098730087`*^9, 3.656354515088489*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"aa", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0.4", ",", "0.5", ",", "0.005"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"aa", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.5", ",", "1.0"}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inds", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "aa", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.656332018422363*^9, {3.656427608119383*^9, 3.656427649521008*^9}, {
   3.656632394806718*^9, 3.6566323998740997`*^9}, {3.6566333624767714`*^9, 
   3.6566333793720446`*^9}, {3.6566336424796004`*^9, 
   3.6566336746650767`*^9}, {3.656633717563699*^9, 3.6566337257681737`*^9}, 
   3.6566338928936853`*^9, {3.6566351651345706`*^9, 3.6566351695625257`*^9}, {
   3.6566352119618154`*^9, 3.6566352627627115`*^9}, {3.6566398211010685`*^9, 
   3.656639836578397*^9}, 3.6566444337067685`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D density", "Subsubsection",
 CellChangeTimes->{{3.656270980626503*^9, 3.6562709855577955`*^9}, {
  3.6563506934185314`*^9, 3.6563506955449514`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ctplt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ContourPlot", "[", 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{"\[Theta]0", "[", 
          RowBox[{"\[Theta]", ",", "\[Delta]", ",", "#"}], "]"}], ",", "#"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Delta]", ",", "0", ",", "0.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"2", "*", "#"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[CapitalDelta]\>\"", ",", "Bold", ",", 
            RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[Theta]\>\"", ",", "Bold", ",", 
            RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"\"\<\[Alpha]=\>\"", "<>", 
           RowBox[{"ToString", "[", "#", "]"}]}], ",", 
          RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], "/@", 
    "aa"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Pressure/PDFs2D.pdf\>\""}], ",", "ctplt"}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6563319541895037`*^9, 3.656331981234548*^9}, {
   3.6563320414257107`*^9, 3.65633208117023*^9}, {3.6563321204684505`*^9, 
   3.656332233921151*^9}, {3.656332308594975*^9, 3.6563323187387447`*^9}, {
   3.6564259543379197`*^9, 3.6564259576251125`*^9}, {3.656427583213764*^9, 
   3.6564275842494564`*^9}, 3.6564278332693834`*^9, {3.6566324201496277`*^9, 
   3.6566324758067636`*^9}, {3.656633145481984*^9, 3.6566331530130105`*^9}, {
   3.656633394957444*^9, 3.6566334040054817`*^9}, {3.656634237327504*^9, 
   3.6566342399982862`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Marginalise at selected points", "Subsubsection",
 CellChangeTimes->{{3.6562665046203985`*^9, 3.656266513042022*^9}, {
  3.656271000395704*^9, 3.656271007027133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"npoints", "=", "30"}], ";", 
  RowBox[{"df", "=", "3.0"}], ";", 
  RowBox[{"dd", "=", 
   RowBox[{"df", "/", "npoints"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltas", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"\[Delta]", ",", 
     RowBox[{"{", 
      RowBox[{"\[Delta]", ",", "0.0", ",", "df", ",", "dd"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"points", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"\[Theta]0", "[", 
             RowBox[{"\[Theta]", ",", "\[Delta]", ",", 
              RowBox[{"aa", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"aa", "[", 
             RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "5"}], "}"}], ",", 
          RowBox[{"MaxRecursion", "\[Rule]", "12"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Delta]", ",", "0.0", ",", "df", ",", "dd"}], "}"}]}], 
       "]"}], "&"}], "/@", "inds"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"deltas", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["\[Delta]", "2"], ",", 
       RowBox[{"{", 
        RowBox[{"\[Delta]", ",", "0.0", ",", 
         SqrtBox["df"], ",", 
         RowBox[{"dd", "/", 
          SqrtBox["df"]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"points", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"\[Rho]", "[", 
            RowBox[{"\[Theta]", ",", 
             RowBox[{"\[Theta]0", "[", 
              RowBox[{"\[Theta]", ",", "\[Delta]", ",", 
               RowBox[{"aa", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"aa", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "0", ",", "5"}], "}"}], ",", 
           RowBox[{"MaxRecursion", "\[Rule]", "12"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Delta]", ",", "0.0", ",", 
           SqrtBox["df"], ",", 
           RowBox[{"dd", "/", 
            SqrtBox["df"]}]}], "}"}]}], "]"}], "&"}], "/@", "inds"}]}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgdata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{"Flatten", "@*", "List"}], ",", 
       RowBox[{"{", 
        RowBox[{"deltas", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Log", "[", "points", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lndata", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{"Flatten", "@*", "List"}], ",", 
       RowBox[{"{", 
        RowBox[{"deltas", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
    "points"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.656252484074924*^9, 3.6562525053061028`*^9}, {
   3.6562527676532993`*^9, 3.656252784521564*^9}, {3.656252912337921*^9, 
   3.6562529225227222`*^9}, {3.6562531354389086`*^9, 3.656253182960644*^9}, {
   3.6562532461428375`*^9, 3.6562533733387794`*^9}, {3.6562536143087006`*^9, 
   3.656253687592641*^9}, 3.6562537193078203`*^9, {3.6562538318679886`*^9, 
   3.6562539127920294`*^9}, {3.6562541609787703`*^9, 
   3.6562541769904633`*^9}, {3.656254384415983*^9, 3.656254398048087*^9}, {
   3.6562546351884503`*^9, 3.6562547190484543`*^9}, {3.6562547571989307`*^9, 
   3.656254760874385*^9}, {3.6562548117623672`*^9, 3.656254840054263*^9}, {
   3.6562549180233293`*^9, 3.65625492352*^9}, {3.656254995912345*^9, 
   3.656254995944366*^9}, {3.6562554351957*^9, 3.656255466070319*^9}, {
   3.6562563043541303`*^9, 3.6562563222370725`*^9}, 3.656266198005639*^9, {
   3.6562663162586083`*^9, 3.6562663218443375`*^9}, {3.6562664232960887`*^9, 
   3.6562664282523985`*^9}, 3.656332104207602*^9, {3.6563524246506715`*^9, 
   3.656352458591319*^9}, {3.656352599031026*^9, 3.6563525994803257`*^9}, {
   3.6563527480974874`*^9, 3.6563527872596188`*^9}, {3.656352977740714*^9, 
   3.656352997011573*^9}, {3.656353155979642*^9, 3.6563531636787796`*^9}, 
   3.656353349613842*^9, {3.656353700848197*^9, 3.6563537350760365`*^9}, {
   3.6563538715621033`*^9, 3.6563538716721783`*^9}, {3.6563539042228975`*^9, 
   3.656353904689208*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.65664488092717*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6566448822760706`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical integration converging too slowly; suspect one \
of the following: singularity, value of the integration is 0, highly \
oscillatory integrand, or WorkingPrecision too small. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/slwcon\\\", ButtonNote -> \
\\\"NIntegrate::slwcon\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6566448839281735`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: slwcon\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.656644884257393*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot marginalised pdf with fits", "Subsubsection",
 CellChangeTimes->{{3.6562664893752155`*^9, 3.65626649505501*^9}, {
  3.6562710123616962`*^9, 3.6562710281672506`*^9}, {3.656353979892387*^9, 
  3.656353981756631*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lfit", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "x"}]}], "/.", 
      RowBox[{"FindFit", "[", 
       RowBox[{
        RowBox[{"lgdata", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"a", "+", 
         RowBox[{"b", " ", "x"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "}"}], ",", "x"}], "]"}]}], "&"}], 
    "/@", "inds"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qfit", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["x", "2"]}]}], "/.", 
      RowBox[{"FindFit", "[", 
       RowBox[{
        RowBox[{"lgdata", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"a", "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["x", "2"]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "x"}], "]"}]}], "&"}], 
    "/@", "inds"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ftplt", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"lgdata", ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\[CapitalDelta]\>\"", ",", "\"\<Log[p(\[CapitalDelta])]\>\""}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "\[Rule]", "aa"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TemporalData", "[", 
        RowBox[{
         RowBox[{"lfit", "/.", 
          RowBox[{"(", 
           RowBox[{"x", "\[Rule]", "deltas"}], ")"}]}], ",", 
         RowBox[{"{", "deltas", "}"}]}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TemporalData", "[", 
        RowBox[{
         RowBox[{"qfit", "/.", 
          RowBox[{"(", 
           RowBox[{"x", "\[Rule]", "deltas"}], ")"}]}], ",", 
         RowBox[{"{", "deltas", "}"}]}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Dashed", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<Pressure/PDF_fits.pdf\>\""}], ",", "ftplt"}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6563512476163116`*^9, 3.656351272588975*^9}, {
  3.6563513126937337`*^9, 3.656351433807545*^9}, {3.656351479390961*^9, 
  3.65635153104943*^9}, {3.656351609147539*^9, 3.656351679149247*^9}, {
  3.6563517099007654`*^9, 3.6563518245582695`*^9}, {3.65635189465604*^9, 
  3.65635200380687*^9}, {3.6563520701561403`*^9, 3.6563522233943872`*^9}, {
  3.6563530939732704`*^9, 3.656353106234451*^9}, {3.6563546410975666`*^9, 
  3.656354737770071*^9}, {3.6566338216581545`*^9, 3.6566338666111493`*^9}, {
  3.656635050634176*^9, 3.656635065135847*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lfit", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "+", 
       RowBox[{"b", " ", "x"}]}], "/.", 
      RowBox[{"FindFit", "[", 
       RowBox[{
        RowBox[{"lgdata", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"a", "+", 
         RowBox[{"b", " ", "x"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "}"}], ",", "x"}], "]"}]}], "&"}], 
    "/@", "inds"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qfit", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["x", "2"]}]}], "/.", 
      RowBox[{"FindFit", "[", 
       RowBox[{
        RowBox[{"lgdata", "[", 
         RowBox[{"[", "#", "]"}], "]"}], ",", 
        RowBox[{"a", "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["x", "2"]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "x"}], "]"}]}], "&"}], 
    "/@", "inds"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lgplt", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", "lgdata", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TemporalData", "[", 
        RowBox[{
         RowBox[{"lfit", "/.", 
          RowBox[{"(", 
           RowBox[{"x", "\[Rule]", "deltas"}], ")"}]}], ",", 
         RowBox[{"{", "deltas", "}"}]}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[CapitalDelta]\>\"", ",", "\"\<Log[p(\[CapitalDelta])]\>\""}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lnplt", "=", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"lndata", ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\[CapitalDelta]\>\"", ",", "\"\<p(\[CapitalDelta])\>\""}],
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdf", "=", 
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lnplt", ",", "lgplt"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "->", "Full"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Pressure/pdf.pdf\>\""}], ",", "pdf"}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.656256460849639*^9, 3.656256470595147*^9}, {
   3.656256510837021*^9, 3.6562565231522446`*^9}, {3.6562601671074877`*^9, 
   3.6562602912694025`*^9}, {3.656260479659211*^9, 3.6562604965665016`*^9}, {
   3.6562662708983154`*^9, 3.6562663047509236`*^9}, {3.656266436038598*^9, 
   3.656266441388171*^9}, {3.656266563329604*^9, 3.6562665746391563`*^9}, {
   3.65626926970694*^9, 3.6562693293697824`*^9}, 3.656269493771572*^9, {
   3.656270837852158*^9, 3.6562708729556*^9}, 3.656270919309554*^9, 
   3.656343553658092*^9, {3.656351873741085*^9, 3.6563518752550964`*^9}, {
   3.65635199334689*^9, 3.6563519941474247`*^9}, {3.656352031341243*^9, 
   3.656352037364261*^9}, {3.656352232496461*^9, 3.656352256599543*^9}, {
   3.65635228979169*^9, 3.6563523277169952`*^9}, {3.6563533817532873`*^9, 
   3.65635338291406*^9}, 3.656353638282452*^9, {3.656354905375902*^9, 
   3.656354910964631*^9}, {3.6564258986047325`*^9, 3.656425915729159*^9}, {
   3.6566350770548*^9, 3.656635081919047*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pressure", "Subsubsection",
 CellChangeTimes->{{3.6562663613687325`*^9, 3.6562663630738707`*^9}, {
  3.6562664758071566`*^9, 3.656266477347184*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{"lndata", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", "inds"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prs", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Plot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"aa", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "*", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "\[Delta]"}], "}"}]}], "]"}]}], 
           "&"}], "/@", "inds"}], "//", "Evaluate"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Delta]", ",", "0", ",", "df"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\[CapitalDelta]\>\"", ",", "\"\<P(\[CapitalDelta])\>\""}], 
          "}"}]}], ",", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "\[Rule]", "aa"}]}], "]"}], "//", "Quiet"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"aa", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "*", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "[", "x", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "df"}], "}"}]}], "]"}]}], "&"}], "/@",
           "inds"}], "//", "Evaluate"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "df"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Dashed", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Pressure/pressure.pdf\>\""}], ",", "prs"}], "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.65626042354874*^9, 3.656260430210189*^9}, {
   3.656260503705269*^9, 3.6562605471983147`*^9}, {3.656260587886486*^9, 
   3.6562606518932295`*^9}, {3.6562656373172073`*^9, 3.656265697861639*^9}, {
   3.65626573742706*^9, 3.656265743092845*^9}, {3.6562658126102695`*^9, 
   3.656265858752082*^9}, {3.6562658975129676`*^9, 3.6562659908382907`*^9}, {
   3.6562660296261935`*^9, 3.6562660357452803`*^9}, {3.656266161053961*^9, 
   3.6562661709315567`*^9}, {3.6562676065692863`*^9, 3.656267661588028*^9}, {
   3.6562677954204025`*^9, 3.6562678647086735`*^9}, {3.6562681269217806`*^9, 
   3.6562681349101152`*^9}, {3.656271085452506*^9, 3.656271091923827*^9}, {
   3.6562712222418547`*^9, 3.656271228970348*^9}, {3.656271314993795*^9, 
   3.6562713391249094`*^9}, 3.656271403213709*^9, {3.6562714431653876`*^9, 
   3.6562714442611203`*^9}, {3.656271577527117*^9, 3.656271611279657*^9}, {
   3.656271644897106*^9, 3.6562716474888377`*^9}, {3.6562716798314357`*^9, 
   3.6562716881299777`*^9}, {3.65627174428848*^9, 3.6562717444736032`*^9}, {
   3.6563318640133343`*^9, 3.656331895819557*^9}, {3.656332627354663*^9, 
   3.6563326701011863`*^9}, 3.656343560416601*^9, {3.6563507335032773`*^9, 
   3.6563507436170254`*^9}, 3.6563508653532524`*^9, {3.656350928032074*^9, 
   3.656350929497052*^9}, {3.6563548438348393`*^9, 3.6563548928105197`*^9}, {
   3.6566351126805706`*^9, 3.6566351316402235`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{"lndata", "[", 
       RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", "inds"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pra", "=", 
  RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"aa", ",", 
       RowBox[{"aa", "*", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "[", "x", "]"}], "&"}], "/@", 
           "inds"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], "}"}], "//",
      "Transpose"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "\"\<Pressure\>\""}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<\[Alpha]\>\"", ",", "\"\<P\>\""}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Pressure/pressure_alpha_peak.pdf\>\""}], ",", "pra"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6562669627493396`*^9, 3.6562669760602274`*^9}, {
   3.656267041541957*^9, 3.6562670501927333`*^9}, 3.6562680485294294`*^9, {
   3.656268162192333*^9, 3.656268164449842*^9}, {3.6563526404386544`*^9, 
   3.6563527228556466`*^9}, {3.656352831151906*^9, 3.656352880412774*^9}, {
   3.656353060837161*^9, 3.656353065355175*^9}, {3.6563532404229865`*^9, 
   3.656353244297571*^9}, {3.656354077663623*^9, 3.656354105902465*^9}, {
   3.6563542942681494`*^9, 3.656354338342558*^9}, {3.656425792024618*^9, 
   3.6564258459886255`*^9}, 3.6564287201774035`*^9, 3.6566323814297924`*^9, {
   3.656633341614851*^9, 3.656633346710252*^9}, {3.6566353047497272`*^9, 
   3.656635305371142*^9}, {3.656639854897621*^9, 3.656639855313898*^9}, {
   3.656644409326501*^9, 3.6566444149122286`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, GraphicsComplexBox[CompressedData["
1:eJztks8rA2AcxpelmJOamyYkXLRQFPMghUhNFJrl9w5aOCkuihEl4kQ54SJx
mhAO3x04GLto7CdSaHKRu/ddPfkHHD319va5PO/3++nNHRhrH04xGAxQR9+b
GzoPKGlY8n7VCD7sxxZP4gELo4Gq9EZBjSm4PW4LIWovaLG2CVblu8ixEkLi
6qXV3SF4njIfND6FUFt77vd1C8rLdMKw1GenVjoF8wldGIa1R7r8/YJ71WYK
hmGyvR0tDgmKHSuqMYJlb5phbEQwreumIri42S2cdQn81zoRuA/PbJeKczy6
MApj6ft+neIJmx4wikRH+dr3sMCnx5MoAu7O1tdBQZauM8fQbHTWZ6r3XSM6
MbhOd/LXewUnFl0Yw5s1HOpW82fodU1x5O1tLQyq/ZLjOeLwNhj7fGr/ZN1B
HHczqZ7JJtEaVR7Re3HrnKsT0GdFwWfue/WvTzJ9kumTTJ9k+iTTJ5k+yfRJ
pk8yfZLpk0yfZPok0yeZPsn0SaZPMn2S6ZNMn+T///m3//MH3zvhcw==
    "], {{{}, {}, {}, {}, 
      {RGBColor[0.368417, 0.506779, 0.709798], Opacity[0.3], LineBox[{22, 1}],
        LineBox[{23, 2}], LineBox[{24, 3}], LineBox[{25, 4}], 
       LineBox[{26, 5}], LineBox[{27, 6}], LineBox[{28, 7}], LineBox[{29, 8}],
        LineBox[{30, 9}], LineBox[{31, 10}], LineBox[{32, 11}], 
       LineBox[{33, 12}], LineBox[{34, 13}], LineBox[{35, 14}], 
       LineBox[{36, 15}], LineBox[{37, 16}], LineBox[{38, 17}], 
       LineBox[{39, 18}], LineBox[{40, 19}], LineBox[{41, 20}], 
       LineBox[{42, 21}]}}, {{}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.019444444444444445`], AbsoluteThickness[1.6], 
       PointBox[{43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 
        58, 59, 60, 61, 62, 63}]}, {}}}], {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"\[Alpha]\"", TraditionalForm], 
    FormBox["\"P\"", TraditionalForm]},
  AxesOrigin->{0.39843750000000006`, 0.14248384625197172`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotLabel->FormBox["\"Pressure\"", TraditionalForm],
  PlotRange->{{0.4, 0.5}, {0.14254614223730883`, 0.14379206194405061`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6562669796156015`*^9, {3.6562670439225473`*^9, 3.6562670510563107`*^9}, 
   3.6562680570781384`*^9, {3.6562681542210107`*^9, 3.6562681650432386`*^9}, 
   3.656270946470694*^9, 3.656331454905363*^9, 3.656343707043437*^9, 
   3.656352725504414*^9, 3.6563528866159143`*^9, {3.6563532576174583`*^9, 
   3.6563532585250635`*^9}, {3.656354048661271*^9, 3.65635410856424*^9}, {
   3.6563543068385363`*^9, 3.6563543391480947`*^9}, 3.656426036079461*^9, 
   3.656427965088724*^9, 3.656632924438496*^9, 3.656633575270756*^9, 
   3.656635889971078*^9, 3.656639913649822*^9, 3.656644417870202*^9, 
   3.6566451159189663`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1348, 685},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
CellContext->Notebook,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 143, 1, 70, "Section"],
Cell[726, 25, 404, 10, 52, "Input"],
Cell[CellGroupData[{
Cell[1155, 39, 100, 1, 39, "Subsubsection"],
Cell[1258, 42, 3701, 85, 127, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4996, 132, 111, 1, 39, "Subsubsection"],
Cell[5110, 135, 1143, 30, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6290, 170, 156, 2, 39, "Subsubsection"],
Cell[6449, 174, 2268, 52, 132, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8754, 231, 172, 2, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[8951, 237, 4592, 110, 170, "Input"],
Cell[13546, 349, 577, 11, 21, "Message"],
Cell[14126, 362, 580, 11, 21, "Message"],
Cell[14709, 375, 580, 11, 21, "Message"],
Cell[15292, 388, 535, 11, 21, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15876, 405, 225, 3, 39, "Subsubsection"],
Cell[16104, 410, 3489, 96, 195, "Input"],
Cell[19596, 508, 4067, 107, 235, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23700, 620, 154, 2, 39, "Subsubsection"],
Cell[23857, 624, 4012, 93, 232, "Input"],
Cell[CellGroupData[{
Cell[27894, 721, 2220, 52, 132, "Input"],
Cell[30117, 775, 2870, 56, 256, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
